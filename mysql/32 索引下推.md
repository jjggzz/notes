# 索引下推（using index condition）

在使用联合索引进行数据查询时，如果不是覆盖索引的情况下，需要进行回表操作，由于mysql索引的最左前缀匹配原则，在使用过范围查询之后，后续索引会失效。那么mysql是如何操作的呢？**它通过索引过滤之后，将得到的主键进行回表，拿到数据之后到内存中再进行剩下条件的过滤**，如果不匹配则丢弃，匹配则保留。这样无疑性能很差

所以引入了**索引下推这一优化手段，从而减少回表的次数**，提升效率。具体操作为：按照左前缀匹配原则进行过滤，假如有范围查询，导致后续索引失效，此时并不急着回表，而是继续使用后续失效的索引再索引树上进行匹配，可能这次匹配过滤出更少的数据，然后再回表。

```sql
## 索引为 age,name,salary
## 如果没有索引下推，那么只会用上age,name，假如搜索出1000条数据，然后回表，对这1000条数据进行加载最后进行salary = 10000的条件进行匹配，可能最终得到10条数据
## 引入索引下推之后，虽然也只是使用上age,name进行搜索，但是结束后不急着回表，再在这个联合索引中对salary = 10000进行匹配，最终得到10个id，然后回表10次即可
## 无疑是使用索引下推的情况性能更好
select * from temp where age = 20 and name like '张%' and salary = 10000;
```


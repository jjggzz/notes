#  innodb索引

innodb采用B+tree作为索引结构，利用Btree的多路搜索的特性并在其上做了增强。

1. 所有数据都存储在叶子结点，并且叶子结点之间用双向链表连接起来，以支持范围搜索。
2. 非叶子结点不存储数据只存储目录。
3. 每页结点都会有页目录，以供进行页内的二分查找。
4. 由于是排好序的结构，故从左到右一次递增，并且会记录每页最大值和最小值
5. 数据页内的每个数据项之间用单向链表进行链接
6. 数据项标志和数据目录标志不同，这样就可以知道当前在进行目录搜索还是已经进行到数据搜索了。

## 聚簇索引

聚簇索引是一种数据存储方式（索引即数据，数据即索引）。mysql的innodb在数据插入的时候默认以主键聚簇索引的方式进行存储。B+tree的插入性能严重依赖于插入顺序，如果插入的主键是无序的，可能会涉及到页分裂，严重影响性能

## 二级索引

在innodb中，除了聚簇索引以外的索引统称为二级索引或者辅助索引（可以有多个）。该类型的索引结构也是使用B+tree，但是在叶子结点并不冗余数据的完整记录，而是只存储数据的主键，最终获取数据可能会**回表**（到聚簇索引中查找）。

## 联合索引

联合索引也是一种二级索引，只不过，它在排序时是使用多个字段进行排序，第一个字段相同的使用第二个字段排序，如果第二个字段也相同则继续使用下一个。按照这种规则进行排序，在进行查找的时候故遵循最左匹配原则

## innodb中B+tree的特殊处理

1. 根页面的位置一直不动。一开始插入数据时，数据都在根页面，当需要进行页分裂时，数据被复制到新的位置，而根页面此时则存储目录信息。
2. 内结点中目录项记录的唯一性。为保证内结点中数据项是唯一的，内结点中的数据项也会保存主键的值，而不仅仅是索引字段。
3. 一个页面最少存储两条数据。
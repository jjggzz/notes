# 缓存过期

## 缓存删除的方法有哪些？

一般在编程中，对于有过期时间的数据清除有三种策略：立即删除、惰性删除、定期删除。

1. 立即删除：一旦数据失效则立刻执行删除逻辑，这种方式实现需要随时监控数据过期时间，并在过期时马上进行删除。这种策略需要大量的cpu资源对数据进行检查，对cpu不友好
2. 惰性删除：数据失效的时候不管它，当数据被访问的时候判断是否过期，如果过期则清理，并返回空。这种过期策略有可能造成内存泄漏，假如某些key过期了但是一直没有被范围，那么它将不会被清除，而这些内存是没法使用的
3. 定期删除：按照一定的周期对过期的数据进行清除，这种方式需要控制清除频率，过短则类似于立即删除，过长则类似于惰性删除。但是可以设置执行时间的上限，或者随机抽查一些key，在这些key中做数据清除，让清理工作尽量不影响到主业务。如果某些key一直没有被抽查到可能也会有内存泄漏的风险。

## redis缓存淘汰策略

redis结合惰性删除和定期删除两种策略做数据清理，但是有可能内存已经满了，但是客户端还想存入数据。此时要有一种方法来处理客户端的这种操作。

1. 不清除任何key，直接向客户端报出OOM （默认策略）
2. 清除即将过期的key
3. 使用LRU算法，从所有key中淘汰最近使用最少的key （最常用的策略）
4. 使用LRU算法，从设置了过期时间的key中淘汰最近最少使用的key
5. 使用LFU算法，从所有key中淘汰最不常用的key
6. 使用LFU算法，从设置了过期时间的key中淘汰最不常用的key
7. 随机的在所有key中淘汰一些key
8. 随机的在设置了过期时间的key中淘汰一些key

